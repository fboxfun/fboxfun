---
// SpinnerItem Component - Presentation Layer
// Renders individual prize item with active state styling

import type { PrizeItem } from '../data/boxes';

interface Props {
  item: PrizeItem;
  active?: boolean;
}

const { item, active = false } = Astro.props;

// Rarity color mapping
const rarityColors = {
  legendary: 'from-yellow-500 to-orange-600',
  epic: 'from-purple-500 to-pink-600',
  rare: 'from-blue-500 to-cyan-600',
  uncommon: 'from-green-500 to-emerald-600',
  common: 'from-gray-500 to-gray-600'
};

const rarityGlow = {
  legendary: 'shadow-[0_0_30px_rgba(234,179,8,0.6)]',
  epic: 'shadow-[0_0_25px_rgba(168,85,247,0.5)]',
  rare: 'shadow-[0_0_20px_rgba(59,130,246,0.4)]',
  uncommon: 'shadow-[0_0_15px_rgba(34,197,94,0.3)]',
  common: ''
};
---

<div
  class:list={[
    'spinner-item flex-shrink-0 relative transition-all duration-300',
    'w-[180px] h-[220px] rounded-xl p-4',
    'flex flex-col items-center justify-between',
    'border-2 bg-gradient-to-b from-[#1a1a1a] to-[#0a0a0a]',
    'border-[#2a2a2a] opacity-70 scale-95'
  ]}
  data-item-id={item.id}
  data-rarity={item.rarity}
>
  <!-- Rarity indicator -->
  <div class:list={[
    'absolute top-2 right-2 w-3 h-3 rounded-full',
    'bg-gradient-to-br',
    rarityColors[item.rarity]
  ]} />
  
  <!-- Item image -->
  <div class="flex-1 flex items-center justify-center w-full overflow-hidden">
    <img
      src={item.image}
      alt={item.name}
      class="max-w-full max-h-full object-contain transition-transform duration-300"
      loading="lazy"
    />
  </div>
  
  <!-- Item info -->
  <div class="w-full text-center space-y-1 mt-2">
    <p class="text-sm font-medium text-white truncate" title={item.name}>
      {item.name}
    </p>
    <p class:list={[
      'text-lg font-bold bg-gradient-to-r bg-clip-text text-transparent',
      rarityColors[item.rarity]
    ]}>
      ${item.value.toFixed(2)}
    </p>
  </div>
</div>

<style>
  .spinner-item {
    will-change: transform, opacity;
    contain: layout style paint;
  }
  
  /* Active state applied dynamically via JS - center item during spinning */
  .spinner-item.active {
    border-color: white !important;
    opacity: 1 !important;
    transform: scale(1.15) !important;
    z-index: 10;
    transition: all 0.15s ease-out !important;
  }
  
  /* Winner state - stays enlarged after animation stops */
  .spinner-item.winner {
    border-color: #FF3851 !important;
    opacity: 1 !important;
    transform: scale(1.2) !important;
    z-index: 20;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
  }
  
  .spinner-item.active[data-rarity="legendary"],
  .spinner-item.winner[data-rarity="legendary"] {
    box-shadow: 0 0 30px rgba(234, 179, 8, 0.6);
  }
  
  .spinner-item.active[data-rarity="epic"],
  .spinner-item.winner[data-rarity="epic"] {
    box-shadow: 0 0 25px rgba(168, 85, 247, 0.5);
  }
  
  .spinner-item.active[data-rarity="rare"],
  .spinner-item.winner[data-rarity="rare"] {
    box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
  }
  
  .spinner-item.active[data-rarity="uncommon"],
  .spinner-item.winner[data-rarity="uncommon"] {
    box-shadow: 0 0 15px rgba(34, 197, 94, 0.3);
  }
  
  .spinner-item.active img,
  .spinner-item.winner img {
    transform: scale(1.1);
  }
  
  .spinner-item img {
    image-rendering: crisp-edges;
  }
</style>

